# Plan 04.1-01: Mouse Wheel Zoom and Zoom Control Relocation

**Phase:** 4.1 - Timeline Refinement
**Wave:** 1
**Depends On:** None

## Overview

Implement cursor-centered mouse wheel zoom on the timeline chart and relocate zoom buttons from the top controls area to the minimap area. This addresses TIME-03 (mouse wheel zoom) and part of the success criteria #5 (zoom buttons in minimap area).

## Files Modified

- `src/plugins/interactive-dashboard/components/cards/TimelineCard.vue` - Add wheel event handler, move zoom buttons to minimap area

## Tasks

<task id="1">
Add custom wheel event handler for cursor-centered zoom. The handler should:
1. Add `handleWheel(e: WheelEvent)` function that:
   - Calls `e.preventDefault()` to prevent page scroll
   - Gets mouse position relative to plot container
   - Converts pixel position to time coordinates using Plotly's `xaxis.p2d()` method
   - Calculates zoom factor (1.1 for zoom out on scroll down, 0.9 for zoom in on scroll up)
   - Computes new viewport range centered on cursor position
   - Clamps range to valid bounds (0-86400 seconds, min 1 hour range)
   - Updates `viewportStart` and `viewportEnd` refs
   - Calls `Plotly.relayout()` to apply new range
2. Bind wheel listener to `plotContainer` in `onMounted()`
3. Remove wheel listener in `onUnmounted()`
</task>

<task id="2" depends_on="1">
Relocate zoom buttons from `.timeline-controls` to `.minimap-container`. Update template:
1. Remove `.timeline-controls` section from top of template
2. Add `.minimap-controls` section inside `.minimap-container` with zoom buttons positioned as floating overlay in top-right corner
3. Update CSS:
   - Remove `.timeline-controls` styles
   - Add `.minimap-controls` with `position: absolute; top: 4px; right: 8px; z-index: 5`
   - Keep existing `.zoom-btn` styles
</task>

## Verification

<verification>
1. Open a dashboard with TimelineCard
2. Position mouse cursor over a ride bar at a specific time (e.g., 10:00)
3. Scroll mouse wheel up - chart should zoom IN centered on cursor position (10:00 stays under cursor)
4. Scroll mouse wheel down - chart should zoom OUT centered on cursor position
5. Verify page does NOT scroll while zooming
6. Verify zoom respects min range (1 hour) - cannot zoom beyond this
7. Verify zoom respects max range (24 hours) - cannot zoom out beyond full view
8. Verify zoom buttons (+/-/reset) are visible in minimap area (top-right corner)
9. Verify zoom buttons still function correctly after relocation
10. Run `npm run test:run` to ensure no regressions
</verification>

## Must-Haves (Goal-Backward)

**Truths (observable behaviors):**
- User scrolls wheel up over timeline and chart zooms in centered on cursor
- User scrolls wheel down over timeline and chart zooms out centered on cursor
- Zoom buttons are visible in minimap area, not at top of card

**Artifacts:**
- `TimelineCard.vue` contains `handleWheel()` function
- `TimelineCard.vue` template has `.minimap-controls` section with zoom buttons

**Key Links:**
- Wheel event bound to plotContainer div
- handleWheel calls Plotly.relayout for axis range update
- viewportStart/viewportEnd refs updated synchronously before relayout

---
autonomous: true
